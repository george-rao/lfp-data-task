---
title: "PREDOC Sample Data Task"
author: "George Rao"
format:
  html:
    toc: true
    toc-depth: 2
    fig-width: 6
    fig-asp: 0.618
    out-width: "70%"
    fig-align: left
  pdf:
    toc: true
    toc-depth: 2
    fig-width: 6
    fig-asp: 0.618
    out-width: "70%"
    fig-align: left
editor_options:
  chunk_output_type: console
---

### Load packages, import data, and clean variables
```{r}
#| message: false
#| warning: false
library(tidyverse)
library(DescTools)
library(gt)
theme_set(theme_bw())

raw_data <- read_csv("data/cps_women_lfp.csv")

# Reorder factors
data <- raw_data |>
  mutate_if(is_character, as_factor) |>
  mutate(
    education = fct_relevel(
      education, "< HS Diploma", "HS Diploma",
      "Some college, no degree", "Associate's Degree",
      "Bachelor's Degree", "Master's or Higher"
    ),
    age = fct_relevel(
      age, "< 25", "25-34", "35-44", "45-54",
      "55-64", "65-74", "75+"
    ),
    wageinc_quantiles = fct_relevel(
      wageinc_quantiles, "0-19.99", "20-39.99",
      "40-59.99", "60-79.99", "80-100"
    ),
    income_quantiles = fct_relevel(
      income_quantiles, "0-19.99", "20-39.99",
      "40-59.99", "60-79.99", "80-100"
    )
  )
```

# Part 1: Labor Force Participation

### Create new variables and filter dataset
```{r}
# Since LFP is the variable of interest, filter out NAs
all <- data |>
  filter(!is.na(lfp))

# Create new variables
all <- all |>
  mutate(
    lfp_lgl = lfp == "In labor force",
    college_lgl = college == "Has college degree",
    # This logical is true if we know the individual is self-employed,
    # but false otherwise, including if there is a missing value
    self_employed_lgl = if_else(self_employed == "Self-employed",
      TRUE, FALSE, FALSE
    ),
    lfp_lgl_excl_self = !self_employed_lgl & lfp_lgl
  )

# Create filtered data set of women only
women <- all |>
  filter(sex == "Female")

# Create filtered data set of women over 25 only
women_over_25 <- women |>
  filter(age != "< 25" & !is.na(age))
```

### Create function to streamline code
```{r}
plot_mean_by_group_over_time <- function(data, var, group) {
  data |>
    summarize(
      .by = c(year, {{ group }}),
      mean = weighted.mean({{ var }}, wgt, na.rm = TRUE)
    ) |>
    ggplot(aes(x = year, y = mean, color = {{ group }})) +
    geom_line(alpha = 0.75) +
    geom_point(alpha = 0.75) +
    labs(x = "Year")
}
```

## Question 1
> How has female labor force participation evolved since 1994? Please provide graphs and/or tables to support your answer.

### Chart evolution of LFP over time
```{r}
all |>
  plot_mean_by_group_over_time(lfp_lgl, sex) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Female labor force participation hit a peak in 2000",
    subtitle = "Male LFP has been falling nearly continuously since 2000",
    y = "Labor force particpation rate",
    color = "Sex"
  )

women |>
  filter(!is.na(age)) |>
  mutate(
    over_25 = if_else(age != "< 25", ">= 25", age)
  ) |>
  plot_mean_by_group_over_time(lfp_lgl, over_25) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Younger women have participated less in the labor force since 2000",
    subtitle = "The trend seems to be reversing in recent years, since COVID in 2020",
    y = "Labor force particpation rate",
    color = "Age group"
  )

women |>
  filter(!is.na(age)) |>
  mutate(
    over_25 = if_else(age != "< 25", ">= 25", age)
  ) |>
  summarize(
    .by = c(year, over_25),
    lfp_rate = weighted.mean(lfp_lgl, wgt, na.rm = TRUE)
  ) |>
  ggplot(aes(x = year, y = lfp_rate, color = over_25)) +
  geom_line(alpha = 0.75) +
  geom_point(alpha = 0.75) +
  labs()
```

## Question 2
> Among women older than 25, which groups (race, age, income percentile, etc.) of people had the biggest changes in labor force participation since 1994? Please provide at least three graphs and/or tables to support your answer.

### Create function to streamline code
```{r}
chg_by_group <- function(data, var, group, initial_year, final_year) {
  data |>
    summarize(
      .by = {{ group }},
      initial = weighted.mean(
        if_else(year == initial_year, {{ var }}, NA), wgt,
        na.rm = TRUE
      ),
      final = weighted.mean(
        if_else(year == final_year, {{ var }}, NA), wgt,
        na.rm = TRUE
      ),
      chg = final - initial
    ) |>
    arrange(desc(chg)) |>
    gt() |>
    opt_align_table_header(align = "left") |>
    cols_align(align = "left", columns = {{ group }}) |>
    cols_label(
      initial = initial_year,
      final = final_year,
      chg = "Change"
    ) |>
    fmt_percent() |>
    sub_missing(columns = initial:chg, missing_text = "") |>
    tab_options(table.align = "left")
}
```

### Examine changes by race
```{r}
women_over_25 |>
  plot_mean_by_group_over_time(lfp_lgl, race) +
  facet_wrap(vars(race), ncol = 3) +
  theme(legend.position = "none") +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Black women have the highest LFP rate",
    subtitle = "The rate for white women (the largest group) is the lowest",
    y = "Labor force participation rate",
    color = "Race"
  )
women_over_25 |>
  chg_by_group(lfp_lgl, race, 1994, 2024) |>
  cols_label(1 ~ "Race") |>
  tab_header(
    title = "Hispanic women experienced the biggest rise in LFP",
    subtitle = "White women experienced the biggest fall"
  )
```

### Examine changes by age
```{r}
women_over_25 |>
  plot_mean_by_group_over_time(lfp_lgl, age) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Women aged 25-54 have LFP rates approaching 80%",
    subtitle = "Labor force participation declines quickly after age 55",
    y = "Labor force participation rate",
    color = "Age"
  )
women_over_25 |>
  chg_by_group(lfp_lgl, age, 1994, 2024) |>
  cols_label(1 ~ "Age group") |>
  tab_header(
    title = "Working into old age has become increasingly common",
    subtitle = "Women aged 55-74 experienced the biggest rise in LFP"
  )
```

### Examine changes by income
```{r}
women_over_25 |>
  plot_mean_by_group_over_time(lfp_lgl, income_quantiles) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Women in the highest income quintiles have the highest LFP rate",
    subtitle = "The effect may be reciprocal as working also causes higher income",
    y = "Labor force participation rate",
    color = "Income quintile"
  )
# Since the 2024 data is not yet available, compare with the 2023 rate
women_over_25 |>
  chg_by_group(lfp_lgl, income_quantiles, 1994, 2023) |>
  cols_label(1 ~ "Income quintile") |>
  tab_header(
    title = "The lowest earners experienced the biggest drop in LFP",
    subtitle = "The highest quintile of female earners were relatively unaffected"
  ) |>
  tab_footnote(
    footnote = "The 2023 rate is used for comparison as 2024 income data is not yet available.",
    locations = cells_column_labels(3)
  )
```

## Question 3
> Use the data to examine trends among women older than 25 for each of the following factors from 1994 to 2024:
(a) Wage and salary income
(b) Social insurance income
(c) Education attainment
Based on these trends, what factors could be driving the patterns you found in Questions 1 and 2?

### Create function to streamline code
```{r}
plot_income_over_time_by_group <- function(data, income_var, group) {
  data |>
    filter({{ income_var }} != 0) |>
    summarize(
      .by = c(year, {{ group }}),
      mean_income = weighted.mean({{ income_var }}, wgt, na.rm = TRUE)
    ) |>
    filter(!is.na({{ group }})) |>
    ggplot(aes(x = year, y = mean_income, color = {{ group }})) +
    geom_line(alpha = 0.75) +
    geom_point(alpha = 0.75) +
    scale_y_continuous(labels = scales::dollar) +
    labs(x = "Year")
}
```

### Examine wage and salary income per woman earning an income
```{r}
women_over_25 |>
  plot_income_over_time_by_group(income) +
  labs(
    title = "Average earned income for income-earning women has increased",
    subtitle = "Women earning an income earned about $20,000 more in 2020 than in 1994",
    y = "Average earned income"
  )

women_over_25 |>
  plot_income_over_time_by_group(income, race) +
  labs(
    title = "Average earned income has increased across all races",
    subtitle = "However, White and AAPI women have seen the largest increases",
    y = "Average earned income",
    color = "Race"
  )

women_over_25 |>
  plot_income_over_time_by_group(income, age) +
  labs(
    title = "Increases in income have been level across age groups",
    subtitle = "The average working elderly woman is earning double what she earned in 1994",
    y = "Average earned income",
    color = "Age group"
  )
```

Average income has increased across the board. The most relevant observation is that income has increased the most for women aged 65 and older who are earning an income. This is not due to the effect of more elderly women working (those not working have been filtered out), but that the average working elderly woman is earning a higher income. This may be related to the increase in LFP for women over 65, with the logic that higher wages are associated with higher LFP, but it's hard to say that this relationship holds for all groups. For instance, Asian or Pacific Islander women experienced a dramatic increase in average income but had almost no change in LFP since 1994.

### Examine average social insurance income per woman who was receiving it
```{r}
women_over_25 |>
  plot_income_over_time_by_group(incss) +
  labs(
    title = "Average social insurance income (SII) has increased since 1994",
    subtitle = "SII increased sharply during the Great Recession and in 2020 during COVID"
  )

women_over_25 |>
  plot_income_over_time_by_group(incss, race) +
  facet_wrap(vars(race), ncol = 3) +
  theme(legend.position = "none") +
  labs(
    title = "White women have received the highest average SII over time",
    subtitle = "The rise in SII has been approximately similar across races",
    y = "Average social insurance income",
  )

women_over_25 |>
  plot_income_over_time_by_group(incss, age) +
  facet_wrap(vars(age), ncol = 3) +
  theme(legend.position = "none") +
  labs(
    title = "Average SII has increased sharply for women 55 to 74",
    subtitle = "It has increased to a lesser extent for other age groups",
    y = "Average social insurance income"
  )
```

### Examine average income earned of each type
```{r warning=FALSE}
women_over_25 |>
  mutate(
    across(inctot:income, \(x) if_else(x == 0, NA, x))
  ) |>
  summarize(
    .by = year,
    across(
      .cols = inctot:income,
      .fns = list(
        mean = \(x) weighted.mean(x[!is.na(x)], wgt[!is.na(x)]),
        median = \(x) Quantile(x[!is.na(x)], wgt[!is.na(x)], 0.5)
      )
    )
  ) |>
  pivot_longer(
    cols = inctot_mean:income_median,
    names_sep = "_",
    names_to = c("income_type", "stat"),
    values_to = "value"
  ) |>
  ggplot(aes(x = year, y = value, color = income_type, linetype = stat)) +
  scale_y_continuous(labels = scales::dollar) +
  geom_line(alpha = 0.75) +
  geom_point(alpha = 0.75, size = 1) +
  theme(axis.title.y = element_blank()) +
  labs(
    title = "The typical values for all three kinds of income are increasing",
    subtitle = "Incomes are skewed upward, and much more so for earned income",
    x = "Year",
    color = "Income type",
    linetype = "Statistic",
    caption = str_wrap(
      "Mean and median income received of each type shown for individuals actually receiving that kind of income; individuals for which the given type of income is zero are excluded.",
      width = 65
    )
  ) +
  scale_color_discrete(labels = c("Earned income", "Social insurance income", "Total income")) +
  scale_linetype_discrete(labels = c("Mean", "Median"))
```

### Examine education attainment
```{r}
plot_props_over_time <- function(data, group) {
  data |>
    summarize(
      .by = c(year, {{ group }}),
      wgt_count = sum(wgt)
    ) |>
    mutate(
      .by = c(year),
      prop = wgt_count / sum(wgt_count)
    ) |>
    ggplot(aes(x = year, y = prop, color = {{ group }})) +
    geom_line(alpha = 0.75) +
    geom_point(alpha = 0.75) +
    labs(x = "Year", y = "Proportion") +
    scale_y_continuous(labels = scales::percent)
}

women_over_25 |>
  plot_props_over_time(education) +
  labs(
    title = "Higher education levels are rising",
    subtitle = "Having a bachelor's or master's degree is increasingly common",
    color = "Education level"
  )

women_over_25 |>
  plot_mean_by_group_over_time(college_lgl) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Higher education increasing among women over 25",
    subtitle = "Rate of having a college degree has doubled since 1994",
    y = "Proportion with college degree"
  )

women_over_25 |>
  plot_mean_by_group_over_time(college_lgl, race) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "Increase in higher education is about equal across race",
    subtitle = "Thus, the racial gap persists over time",
    y = "Proportion with college degree",
    color = "Race"
  )

women_over_25 |>
  plot_mean_by_group_over_time(college_lgl, age) +
  scale_y_continuous(labels = scales::percent) +
  labs(
    title = "The largest increases in education are in older groups",
    subtitle = "The rate for people 75+ has nearly tripled since 1994",
    y = "Proportion with college degree",
    color = "Age group"
  )
```

The rate of having a college degree is increasing over time for all races and ages. Women aged 75+ seem to have a comparably larger increase in the rate of having a college degree, but the effect seems small.

In conclusion for this question, wages, social insurance income, and education attainment are all increasing for most groups of women during the period since 1994. It is unclear, however, how this might be driving the overall trend in women's LFP. It does seem like there may be a connection between higher wages and education attainment for older women and their relatively large increase in LFP.

## Question 4
> Between 1994 and 2024, which year had the steepest increase in female labor force participation relative to the previous year? What factors do you think are driving this pattern? Support your answers by using the data, referencing major events that happened around this time period, and/or citing previous studies.

### Calculate year-over-year changes in female LFP
```{r}
women_lfp_rate_chg <- women |>
  summarize(
    .by = year,
    lfp_rate = weighted.mean(lfp_lgl, wgt)
  ) |>
  mutate(
    lfp_rate_chg = lfp_rate - lag(lfp_rate)
  ) |>
  select(!lfp_rate) |>
  filter(year != 1994) |>
  arrange(desc(lfp_rate_chg))

bind_rows(
  slice_head(women_lfp_rate_chg, n = 3),
  slice_tail(women_lfp_rate_chg, n = 3),
) |>
  gt() |>
  fmt_percent(lfp_rate_chg) |>
  cols_align(align = "left", columns = year) |>
  cols_label(
    year = "Year",
    lfp_rate_chg = "Change in LFP rate"
  ) |>
  opt_align_table_header(align = "left") |>
  tab_options(table.align = "left") |>
  tab_header(
    title = "The year with the steepest increase in female LFP was 2001",
    subtitle = "This lines up with the September 11 attacks, after which women may have stepped in to fill the labor market gap left by men serving in the subsequent War in Afghanistan"
  )

women_lfp_rate_chg |>
  filter(lfp_rate_chg == max(lfp_rate_chg, na.rm = TRUE))

women_lfp_rate_chg |>
  ggplot(aes(x = year, y = lfp_rate_chg)) +
  geom_col()
```

The year with the steepest increase in female labor force participation relative to the previous year was 2001, with an increase of 1.5% (absolute change in the proportion). This lines up with the September 11 attacks and the subsequent War in Afghanistan, during which women may have stepped in to fill any labor market gaps left by men serving in the war.

## Question 5
> How has labor force participation for college-educated and not college-educated women evolved since 1994? Please provide graphs and/or tables to support your answer.

### Examine LFP by college education status
```{r}
women |>
  summarize(
    .by = c(year, college),
    lfp_rate = weighted.mean(lfp_lgl, wgt)
  ) |>
  ggplot(aes(x = year, y = lfp_rate, color = college)) +
  geom_line(alpha = 0.75) +
  geom_point(alpha = 0.75)
```

College-educated women experienced a slightly larger drop in LFP since 1994 than women without a college education. Furthermore, the drop for college-educated women has been more or less monotonic, with a steady decrease almost every year. The LFP rate for women without a college education, however, initially rose until the early 2000s, after which it experienced a sharper decline.

## Question 6
> Create an alternative measure of labor force participation that excludes individuals from the labor force if they are self-employed in their main job (lfp = 0 if self-employed in main job). Using the new measure, describe how labor force participation for college- educated and not college-educated women has evolved since 1994. Please provide graphs and/or tables to support your answer.

### Examine alternative measure of LFP by college education status
```{r}
women |>
  summarize(
    .by = c(year, college),
    lfp_rate = weighted.mean(lfp_lgl, wgt),
    lfp_rate_excl_self = weighted.mean(lfp_lgl_excl_self, wgt)
  ) |>
  pivot_longer(
    cols = c(lfp_rate, lfp_rate_excl_self),
    names_to = "lfp_type",
    values_to = "lfp_rate"
  ) |>
  ggplot(aes(x = year, y = lfp_rate, color = college, linetype = lfp_type)) +
  geom_line(alpha = 0.75) +
  geom_point(alpha = 0.75, size = 1)
```

The alternative measure of LFP is everywhere lower than the regular measure. The effect of changing to the alternative measure is larger for women with a college degree than for women without a college degree, indicating that a relatively larger proportion of women with a college degree are self-employed. This seems to make sense given that self-employed workers are usually in a skilled or white-collar profession. However, any effects of the recent rise of the gig economy do not seem to be captured in the data, perhaps because they are small relative to the magnitude of the labor force as a whole.

Using the alternative measure, the pattern of women's LFP evolution by college education status is not materially different than when using the original measure.

## Question 7
> How does our labor market analysis change when we use the new measure? Which measure do you prefer? Explain.

### Create function to streamline code
```{r}
compare_lfp_rates_by_group <- function(data, group) {
  data |>
    summarize(
      .by = c(year, {{ group }}),
      lfp_rate = weighted.mean(lfp_lgl, wgt),
      lfp_rate_excl_self = weighted.mean(lfp_lgl_excl_self, wgt)
    ) |>
    pivot_longer(
      cols = c(lfp_rate, lfp_rate_excl_self),
      names_to = "lfp_type",
      values_to = "lfp_rate"
    ) |>
    ggplot(aes(x = year, y = lfp_rate, color = {{ group }}, linetype = lfp_type)) +
    geom_line(alpha = 0.75) +
    geom_point(alpha = 0.75, size = 1)
}
```

### Examine alternative measure of LFP for different cross sections of the data
```{r}
women |> compare_lfp_rates_by_group()
women |> compare_lfp_rates_by_group(age)
women |>
  compare_lfp_rates_by_group(race) +
  facet_wrap(vars(race), ncol = 4) +
  theme(legend.position = "none")
women |> compare_lfp_rates_by_group(income_quantiles)
```

Without analyzing the effect of changing to the new measure on different cross sections of the data, it is hard to say for certain, but it seems that the effect is simply to lower LFP across the board, albeit in differing magnitudes for different demographics.

At the end of the day, the way labor force participation should be measured depends on the goals of the economic analyst. If LFP is simply intended to show how much of the population is working, then self-employment should clearly count as employment because self-employed people are indeed working. In this case, due to the differing effects on different demographics, filtering out self-employed people would distort the numbers.

However, there could be applications of LFP for which it makes sense to filter out self-employed people. Perhaps the self-employed are less likely to try to find a new job if they lose work, or are otherwise unwilling to work if not for themselves; then, it might make sense to exclude them if the goal is to use LFP as a proxy for the size of the active labor market.

# Part 2: Telework

### Create new variables and filter dataset
The most important concept here is that `had_telework` is created while the data is grouped by `cpsidp`. This means that any individual who had telework during COVID is categorized as having had telework for all years. The point is to be able to follow the same individuals (who had telework during COVID) and observe their outcomes post-COVID; the years before COVID can be disregarded into missing values later.

```{r}
all <- data |>
  mutate(
    employed_lgl = employed == "Employed",
    lfp_lgl = lfp == "In labor force",
    covid_telework_lgl =
      covid_telework == "Telework from 2021-2022 due to COVID"
  ) |>
  mutate(
    .by = cpsidp,
    had_telework = any(covid_telework_lgl)
  )

women <- all |>
  filter(sex == "Female")

women_over_25 <- women |>
  filter(age != "< 25")
```

## Question 1
> Since the rise of telework in 2020, how have wages, employment, and labor force participation changed for women who had telework from 2020-2024 and women who did not? Please provide at least three graphs and/or tables to support your answer.

I will attempt to answer this question by comparing women who had telework during COVID and women who did not have telework during COVID.

### Examine labor market outcomes by teleworking status during COVID
```{r}
summary_women_by_telework <- women |>
  filter(income != 0) |>
  summarize(
    .by = c(year, had_telework),
    mean_income = weighted.mean(income, wgt, na.rm = TRUE),
    employment_rate = weighted.mean(employed_lgl, wgt, na.rm = TRUE),
    lfp_rate = weighted.mean(lfp_lgl, wgt, na.rm = TRUE)
  ) |>
  mutate(
    had_telework = case_when(
      year <= 2019 ~ NA,
      year >= 2020 ~ !is.na(had_telework)
    )
  )

summary_women_by_telework |>
  ggplot(aes(x = year, y = mean_income, color = had_telework)) +
  geom_line(alpha = 0.75) +
  geom_point(alpha = 0.75)

summary_women_by_telework |>
  ggplot(aes(x = year, y = employment_rate, color = had_telework)) +
  geom_line(alpha = 0.75) +
  geom_point(alpha = 0.75)

summary_women_by_telework |>
  ggplot(aes(x = year, y = lfp_rate, color = had_telework)) +
  geom_line(alpha = 0.75) +
  geom_point(alpha = 0.75)
```

Women who were able to telework during COVID had markedly better labor outcomes even after 2022, with much higher incomes, employment rates, and LFP rates. There seems to be some regression to the mean in employment rates and LFP rates in 2022 and beyond. For incomes, the effect seems to persist or even expand past 2022.

## Question 2
> For which groups of women older than 25 was telework due to the pandemic most common in 2021? Based on these patterns, what can you infer about the relationship between economic well-being and the ability to telework between 2021? Please provide at least three graphs and/or tables to support your answer.

### Examine 2021 teleworking rates for women older than 25 by demographic factors
```{r}
women_over_25 |>
  filter(year == 2021) |>
  summarize(
    .by = race,
    teleworking_rate = weighted.mean(covid_telework_lgl, wgt, na.rm = TRUE)
  ) |>
  mutate(
    race = fct_reorder(race, teleworking_rate)
  ) |>
  ggplot(aes(x = teleworking_rate, y = race)) +
  geom_point()

women_over_25 |>
  filter(year == 2021) |>
  summarize(
    .by = age,
    teleworking_rate = weighted.mean(covid_telework_lgl, wgt, na.rm = TRUE)
  ) |>
  ggplot(aes(x = teleworking_rate, y = age)) +
  geom_point()

women_over_25 |>
  filter(year == 2021) |>
  summarize(
    .by = education,
    teleworking_rate = weighted.mean(covid_telework_lgl, wgt, na.rm = TRUE)
  ) |>
  ggplot(aes(x = teleworking_rate, y = education)) +
  geom_point()
```

White or Asian/Pacific Islander women had higher rates of telework in 2021 than Black, Native American, and Hispanic women. The more advanced a woman's level of education, the more likely she was able to telework. Although a direct observation of the relationship between income and teleworking rate is unavailable in the data, the aforementioned demographic factors are highly correlated with income. It can therefore be inferred that women with higher incomes were much more likely to be able to telework in 2021.

## Question 3
> Predict what trends in wages, employment, and labor force participation for college- educated women from 2020 to 2024 would have looked like if telework was not an option. What does this tell you about the economic impacts of telework during the COVID-19 pandemic? Please support your answer with graphs and/or tables.
>
> Hint: Look at trends from previous years that had similar economic contexts. Also, feel free to explore the variables you haven’t used yet.

For timing reasons, the answer to this question is kept to a simplistic analysis.

### Examine labor market outcomes for college-educated women by teleworking status during COVID
```{r}
summary_college_women_by_telework <- women |>
  filter(income != 0, college == "Has college degree") |>
  summarize(
    .by = c(year, had_telework),
    mean_income = weighted.mean(income, wgt, na.rm = TRUE),
    employment_rate = weighted.mean(employed_lgl, wgt, na.rm = TRUE),
    lfp_rate = weighted.mean(lfp_lgl, wgt, na.rm = TRUE)
  ) |>
  mutate(
    had_telework = case_when(
      year <= 2019 ~ NA,
      year >= 2020 ~ !is.na(had_telework)
    )
  )

summary_college_women <- women |>
  filter(income != 0, college == "Has college degree") |>
  summarize(
    .by = year,
    mean_income = weighted.mean(income, wgt, na.rm = TRUE),
    employment_rate = weighted.mean(employed_lgl, wgt, na.rm = TRUE),
    lfp_rate = weighted.mean(lfp_lgl, wgt, na.rm = TRUE)
  )

summary_college_women_by_telework |>
  ggplot(aes(x = year, y = mean_income)) +
  geom_line(aes(color = had_telework)) +
  geom_point(aes(color = had_telework))
geom_line(data = summary_college_women)
geom_point(data = summary_college_women)

summary_college_women_by_telework |>
  ggplot(aes(x = year, y = employment_rate)) +
  geom_line(aes(color = had_telework)) +
  geom_point(aes(color = had_telework))
geom_line(data = summary_college_women)
geom_point(data = summary_college_women)

summary_college_women_by_telework |>
  ggplot(aes(x = year, y = lfp_rate)) +
  geom_line(aes(color = had_telework)) +
  geom_point(aes(color = had_telework))
geom_line(data = summary_college_women)
geom_point(data = summary_college_women)
```

Under this simplistic analysis (not attempting to consider a counterfactual), telework caused positive economic impacts for college-educated women during and after the pandemic. Under the assumption that the complete absence of telework during COVID would have caused all college-educated women to experience the same effects as those college-educated women without telework actually experienced during COVID, we can say that the difference between the black and red lines in the above charts represents the impacts of telework. Incomes were higher, employment rates were slightly higher, and LFP rates were higher as a result of telework.
